"use strict";(self["webpackChunkoci_help_web"]=self["webpackChunkoci_help_web"]||[]).push([[968],{968:function(e,a,o){o.r(a),o.d(a,{default:function(){return g}});var t=o(6768),l=o(5130),s=o(4232);const n={class:"login-container"};function r(e,a,o,r,i,d){const c=(0,t.g2)("el-input"),u=(0,t.g2)("el-form-item"),g=(0,t.g2)("el-button"),m=(0,t.g2)("el-form"),h=(0,t.g2)("el-card"),k=(0,t.g2)("el-link"),b=(0,t.g2)("el-footer");return(0,t.uX)(),(0,t.CE)("div",n,[a[9]||(a[9]=(0,t.Lk)("div",{class:"background"},null,-1)),(0,t.bF)(h,{class:"login-card"},{default:(0,t.k6)((()=>[a[7]||(a[7]=(0,t.Lk)("h2",{class:"login-title"},"oci-helper Login",-1)),(0,t.bF)(m,{onSubmit:(0,l.D$)(d.login,["prevent"]),onKeydown:(0,l.jR)((0,l.D$)(d.login,["prevent"]),["enter"])},{default:(0,t.k6)((()=>[(0,t.bF)(u,{label:"","label-width":"0%"},{default:(0,t.k6)((()=>[(0,t.bF)(c,{modelValue:i.loginParams.account,"onUpdate:modelValue":a[0]||(a[0]=e=>i.loginParams.account=e),placeholder:"请输入账号",clearable:""},{prefix:(0,t.k6)((()=>a[3]||(a[3]=[(0,t.Lk)("i",{class:"el-icon-user"},null,-1)]))),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(u,{label:"","label-width":"0%"},{default:(0,t.k6)((()=>[(0,t.bF)(c,{"show-password":"",modelValue:i.loginParams.password,"onUpdate:modelValue":a[1]||(a[1]=e=>i.loginParams.password=e),placeholder:"请输入密码",type:"password",clearable:""},{prefix:(0,t.k6)((()=>a[4]||(a[4]=[(0,t.Lk)("i",{class:"el-icon-lock"},null,-1)]))),_:1},8,["modelValue"])])),_:1}),i.enableMfa?((0,t.uX)(),(0,t.Wv)(u,{key:0},{default:(0,t.k6)((()=>[(0,t.bF)(c,{"show-password":"",modelValue:i.loginParams.mfaCode,"onUpdate:modelValue":a[2]||(a[2]=e=>i.loginParams.mfaCode=e),placeholder:"请输入MFA验证码",clearable:""},{prefix:(0,t.k6)((()=>a[5]||(a[5]=[(0,t.Lk)("i",{class:"el-icon-mobile-phone"},null,-1)]))),_:1},8,["modelValue"])])),_:1})):(0,t.Q3)("",!0),(0,t.bF)(u,{style:{"text-align":"center"},class:"login-button-container"},{default:(0,t.k6)((()=>[(0,t.bF)(g,{type:"primary",onClick:d.login,loading:i.loading,class:"login-button"},{default:(0,t.k6)((()=>a[6]||(a[6]=[(0,t.eW)("Login")]))),_:1},8,["onClick","loading"])])),_:1})])),_:1},8,["onSubmit","onKeydown"])])),_:1}),(0,t.bF)(b,{class:"login-footer"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{href:"https://github.com/Yohann0617",target:"_blank"},{default:(0,t.k6)((()=>a[8]||(a[8]=[(0,t.eW)("© Yohann All Rights Reserved")]))),_:1}),(0,t.bF)(g,{onClick:d.toggleTheme,class:"logout-button",link:""},{default:(0,t.k6)((()=>[(0,t.eW)((0,s.v_)(d.themeText),1)])),_:1},8,["onClick"])])),_:1})])}o(4114);var i=o(1219),d={mounted(){this.getEnableMfa(),this.isDarkMode="dark"===localStorage.getItem("theme")},computed:{themeText(){return this.isDarkMode?"开灯💡":"关灯🌙"}},data(){return{loginParams:{account:"",password:"",mfaCode:null},loading:!1,enableMfa:!1,isDarkMode:"dark"===localStorage.getItem("theme")}},methods:{toggleTheme(){const e=document.documentElement.classList.toggle("dark");localStorage.setItem("theme",e?"dark":"light"),this.isDarkMode=e},getEnableMfa(){this.$axios.post("/sys/getEnableMfa",{}).then((e=>{e.data.success?this.enableMfa=e.data.data:(0,i.nk)({message:e.data.msg,type:"error",duration:2e3})})).catch((e=>{console.error("Error:",e)}))},async login(){if("yohann"!==this.loginParams.account||"yohann"!==this.loginParams.password){this.loading=!0;try{const e=await this.$axios.post("/sys/login",{...this.loginParams});if(e.data.success){(0,i.nk)({message:e.data.msg,type:"success",duration:2e3});let a=e.data.data;sessionStorage.setItem("token",a.token),localStorage.setItem("currentVersion",a.currentVersion),localStorage.setItem("latestVersion",a.latestVersion),setTimeout((()=>{this.$router.push("/dashboard")}),1e3)}else(0,i.nk)({message:e.data.msg,type:"error",duration:2e3}),this.loading=!1}catch(e){console.error("Error:",e),(0,i.nk)({message:"登录失败，请重试",type:"error",duration:2e3}),this.loading=!1}}else(0,i.nk)({message:"该账号为默认账号，请修改并重启后再尝试登录",type:"error",duration:2e3})}}},c=o(1241);const u=(0,c.A)(d,[["render",r],["__scopeId","data-v-6d1fc36b"]]);var g=u}}]);
//# sourceMappingURL=968.a5af1555.js.map